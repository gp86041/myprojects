filter(x,rep(1,nn),sides=1)
}
test<-data.frame(climate[,1],
as.numeric(movsum(climate[,2])))
test2<-data.frame(genesseall,
test[match(genesseall[,1],climate[,1]),2])
test2[is.na(test2)]<-0
#test3<-cor(test2,method="spearman")
test3<-rcorr(as.matrix(test2), type="spearman")$P[2,3]
#print(test2)
print(test3)
}
###############
par(mfrow=c(2,1))
plot(mapply(tf,2:365),main='Precipitation Cumulation Period vs. Correlation Result with Peak Flow',
ylab='Corellation Result Between Cumulative Precipitation and Peak Flow',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf,2:365),col='red')
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
#################
genesseall<-genesseallm[1:24,]
plot(mapply(tf2,2:365),main='Precipitation Cumulation Period vs. Correlation Result with Peak Flow',
ylab='Corellation Result Between Cumulative Precipitation and Peak Flow',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf2,2:365),col='red')
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
abline(h=0.01)
abline(h=0.1)
abline(h=0.05)
polygon(400,0.05,border=NA, col="grey")
x <- seq_along(y)
y2 <- rep(y, each=2)
y2 <- y2[-length(y2)]
x2 <- rep(x, each=2)[-1]
x3 <- c(min(x2), x2, max(x2))
y3 <- c(0, y2, 0)
# because polygon() is dumb and wants a pre-existing plot
plot(x, y, ylim=c(0, max(y)), type="n")
polygon(x3, y3, border=NA, col="grey")
lines(x2, y2)
polygon(400,0.05,border=NA, col="grey")
polygon(400,0.05,border=NA, col="black")
segments(0,0,x1=400,y1=0.05,col="black")
segments(0,0.05,x1=400,y1=0.05,col="black")
polygon(400,0.05,border=NA, col="black")
polygon(c(0:400),seq(0.05,400),border=NA, col="black")
seq(0.05,400)
rep(0.05,400)
polygon(c(0:400),rep(0.05,400),border=NA, col="black")
polygon(c(0:400),rep(0.05,401),border=NA, col="black")
polygon(c(0:400),rep(0.09,401),border=NA, col="black")
genesseall<-genesseallm[28:90,]
points(mapply(tf2,2:365),col='red')
abline(h=0.05)
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
genesseall<-genesseallm[28:90,]
points(mapply(tf2,2:365),col='red')
abline(h=0.05)
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
genesseall<-genesseallm[1:24,]
plot(mapply(tf2,2:365),main='Precipitation Cumulation Period vs. Correlation Result with Peak Flow',
ylab='Corellation Result Between Cumulative Precipitation and Peak Flow',
xlab='Precipitation Cumulation Period (days)')
polygon(c(0:400),rep(0.09,401),border=NA, col="black")
polygon(c(0:400),rep(0.6,401),border=NA, col="black")
c(0:400)
n <- 100
xx <- c(0:n, n:0)
yy <- c(c(0, cumsum(stats::rnorm(n))), rev(c(0, cumsum(stats::rnorm(n)))))
plot   (xx, yy, type = "n", xlab = "Time", ylab = "Distance")
polygon(xx, yy, col = "gray", border = "red")
title("Distance Between Brownian Motions")
data.base(xx,yy)
data.frame(xx,yy)
polygon(c(min(xx), xx, max(xx)), c(max(yy), y, max(yy)), col="gray")
polygon(c(min(xx), xx, max(xx)), c(max(yy), yy, max(yy)), col="gray")
polygon(c(0,100),c(0,10) col="gray")
polygon(c(0,100),c(0,10), col="gray")
polygon(c(0,100),c(10,10), col="gray")
polygon(c(0,100),c(100,10), col="gray")
polygon(c(0,100),c(0,10), col="gray")
polygon(c(100,100),c(0,10), col="gray")
polygon(c(0,100),c(100,10), col="gray")
polygon(c(0,60,100),c(0,5,10), col="gray")
polygon(c(0,100,100),c(0,0,10), col="gray")
genesseall<-genesseallm[1:24,]
plot(mapply(tf2,2:365),main='Precipitation Cumulation Period vs. Correlation Result with Peak Flow',
ylab='Corellation Result Between Cumulative Precipitation and Peak Flow',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf2,2:365),col='red')
abline(h=0.05)
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
polygon(c(0,0,100),c(0,0,0.05), col="gray")
polygon(c(0,0,300),c(0,0,0.05), col="gray")
polygon(c(0,300,300),c(0,0,0.05), col="gray")
polygon(c(0,300,300),c(0,0.05,0.05), col="gray")
polygon(c(0,300,300,0),c(0,0.05,0.05,0.05), col="gray")
polygon(c(0,400,400,0),c(0,0.05,0.05,0.05), col="gray")
polygon(c(0,400,400,0),c(0,0.05,0,0.05), col="gray")
polygon(c(0,0,400,400),c(0,0.05,0,0.05), col="gray")
polygon(c(0,0,400,400),c(0,0.05,0,0.05), col="gray")
polygon(c(0,0,400,400),c(0,0.05,0,0.05), col="gray")
polygon(c(0,400),c(0.05,0.05), col="gray")
polygon(c(0,400),c(0.05,0.05), density=20,col="gray")
polygon(c(0,400,400,0),c(0.05,0.05,0,0), col="gray")
polygon(c(0,400,400,0),c(0.05,0.05,0,0), col=rgb(1, 0, 0,0.5))
polygon(c(0,400,400,0),c(0.05,0.05,0,0), col=rgb(1, 0, 0,0.5))
genesseall<-genesseallm[1:24,]
plot(mapply(tf2,2:365),main='Precipitation Cumulation Period vs. Correlation Result with Peak Flow',
ylab='Corellation Result Between Cumulative Precipitation and Peak Flow',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf2,2:365),col='red')
abline(h=0.05)
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
polygon(c(0,400,400,0),c(0.05,0.05,0,0), col=rgb(220, 220, 220,0.5))
polygon(c(0,400,400,0),c(0.05,0.05,0,0), col=rgb(0.22, 0.22, 0.22,0.5))
polygon(c(0,400,400,0),c(0.5,0.5,0,0), col=rgb(0.22, 0.22, 0.22,0.5))
climate <- read.csv("project1_climate.csv")
genesseallm <- read.csv("project1_genesseall.csv")
genesseall<-genesseallm[1:24,]
tf<-function(nn){
movsum<-function(x){
filter(x,rep(1,nn),sides=1)
}
test<-data.frame(climate[,1],
as.numeric(movsum(climate[,2])))
test2<-data.frame(genesseall,
test[match(genesseall[,1],climate[,1]),2])
test2[is.na(test2)]<-0
test3<-cor(test2,method="spearman")
#test3<-rcorr(as.matrix(test2), type="spearman")$P[2,3]
#print(test2)
print(test3[2,3])
}
tf2<-function(nn){
movsum<-function(x){
filter(x,rep(1,nn),sides=1)
}
test<-data.frame(climate[,1],
as.numeric(movsum(climate[,2])))
test2<-data.frame(genesseall,
test[match(genesseall[,1],climate[,1]),2])
test2[is.na(test2)]<-0
#test3<-cor(test2,method="spearman")
test3<-rcorr(as.matrix(test2), type="spearman")$P[2,3]
#print(test2)
print(test3)
}
###############
par(mfrow=c(2,1))
plot(mapply(tf,2:365),main='Precipitation Cumulation Period vs. Correlation Result with Peak Flow',
ylab='Corellation Result Between Cumulative Precipitation and Peak Flow',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf,2:365),col='red')
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
#################
genesseall<-genesseallm[1:24,]
plot(mapply(tf2,2:365),main='Precipitation Cumulation Period vs. Correlation Result with Peak Flow',
ylab='Corellation Result Between Cumulative Precipitation and Peak Flow',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf2,2:365),col='red')
abline(h=0.05)
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
polygon(c(0,400,400,0),c(0.1,0.1,0,0), col=rgb(0.22, 0.22, 0.22,0.5))
genesseall<-genesseallm[1:24,]
plot(mapply(tf2,2:365),main='P values',
ylab='P values',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf2,2:365),col='red')
abline(h=0.05)
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
polygon(c(0,400,400,0),c(0.1,0.1,0,0), col=rgb(0.22, 0.22, 0.22,0.5))
genesseall<-genesseallm[1:24,]
plot(mapply(tf2,2:365),main='P values',
ylab='P values',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf2,2:365),col='red')
#abline(h=0.1)
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
polygon(c(-100,400,400,-100),c(0.1,0.1,0,0), col=rgb(0.22, 0.22, 0.22,0.5))
climate <- read.csv("project1_climate.csv")
genesseallm <- read.csv("project1_genesseall.csv")
genesseall<-genesseallm[1:24,]
tf<-function(nn){
movsum<-function(x){
filter(x,rep(1,nn),sides=1)
}
test<-data.frame(climate[,1],
as.numeric(movsum(climate[,2])))
test2<-data.frame(genesseall,
test[match(genesseall[,1],climate[,1]),2])
test2[is.na(test2)]<-0
test3<-cor(test2,method="spearman")
#test3<-rcorr(as.matrix(test2), type="spearman")$P[2,3]
#print(test2)
print(test3[2,3])
}
tf2<-function(nn){
movsum<-function(x){
filter(x,rep(1,nn),sides=1)
}
test<-data.frame(climate[,1],
as.numeric(movsum(climate[,2])))
test2<-data.frame(genesseall,
test[match(genesseall[,1],climate[,1]),2])
test2[is.na(test2)]<-0
#test3<-cor(test2,method="spearman")
test3<-rcorr(as.matrix(test2), type="spearman")$P[2,3]
#print(test2)
print(test3)
}
###############
par(mfrow=c(2,1))
plot(mapply(tf,2:365),main='Precipitation Cumulation Period vs. Correlation Result with Peak Flow',
ylab='Corellation Result Between Cumulative Precipitation and Peak Flow',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf,2:365),col='red')
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
#################
genesseall<-genesseallm[1:24,]
plot(mapply(tf2,2:365),main='P values',
ylab='P values',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf2,2:365),col='red')
#abline(h=0.1)
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
polygon(c(-100,400,400,-100),c(0.1,0.1,0,0), col=rgb(0.22, 0.22, 0.22,0.5))
polygon(c(-100,400,400,-100),c(0.05,0.05,0,0), col=rgb(0.22, 0.22, 0.22,0.5))
climate <- read.csv("project1_climate.csv")
genesseallm <- read.csv("project1_genesseall.csv")
genesseall<-genesseallm[1:24,]
tf<-function(nn){
movsum<-function(x){
filter(x,rep(1,nn),sides=1)
}
test<-data.frame(climate[,1],
as.numeric(movsum(climate[,2])))
test2<-data.frame(genesseall,
test[match(genesseall[,1],climate[,1]),2])
test2[is.na(test2)]<-0
test3<-cor(test2,method="spearman")
#test3<-rcorr(as.matrix(test2), type="spearman")$P[2,3]
#print(test2)
print(test3[2,3])
}
tf2<-function(nn){
movsum<-function(x){
filter(x,rep(1,nn),sides=1)
}
test<-data.frame(climate[,1],
as.numeric(movsum(climate[,2])))
test2<-data.frame(genesseall,
test[match(genesseall[,1],climate[,1]),2])
test2[is.na(test2)]<-0
#test3<-cor(test2,method="spearman")
test3<-rcorr(as.matrix(test2), type="spearman")$P[2,3]
#print(test2)
print(test3)
}
###############
par(mfrow=c(2,1))
plot(mapply(tf,2:365),main='Precipitation Cumulation Period vs. Correlation Result with Peak Flow',
ylab='Corellation Result Between Cumulative Precipitation and Peak Flow',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf,2:365),col='red')
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
#################
genesseall<-genesseallm[1:24,]
plot(mapply(tf2,2:365),main='P values',
ylab='P values',
xlab='Precipitation Cumulation Period (days)',
ylim=c(0,0.1))
genesseall<-genesseallm[28:90,]
points(mapply(tf2,2:365),col='red')
#abline(h=0.1)
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
polygon(c(-100,400,400,-100),c(0.05,0.05,0,0), col=rgb(0.22, 0.22, 0.22,0.5))
detach("package:Hmisc", unload=TRUE)
library("Hmisc", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
climate <- read.csv("project1_climate.csv")
genesseallm <- read.csv("project1_genesseall.csv")
genesseall<-genesseallm[1:24,]
tf<-function(nn){
movsum<-function(x){
filter(x,rep(1,nn),sides=1)
}
test<-data.frame(climate[,1],
as.numeric(movsum(climate[,2])))
test2<-data.frame(genesseall,
test[match(genesseall[,1],climate[,1]),2])
test2[is.na(test2)]<-0
test3<-cor(test2,method="spearman")
#test3<-rcorr(as.matrix(test2), type="spearman")$P[2,3]
#print(test2)
print(test3[2,3])
}
tf2<-function(nn){
movsum<-function(x){
filter(x,rep(1,nn),sides=1)
}
test<-data.frame(climate[,1],
as.numeric(movsum(climate[,2])))
test2<-data.frame(genesseall,
test[match(genesseall[,1],climate[,1]),2])
test2[is.na(test2)]<-0
#test3<-cor(test2,method="spearman")
test3<-rcorr(as.matrix(test2), type="spearman")$P[2,3]
#print(test2)
print(test3)
}
###############
par(mfrow=c(2,1))
genesseall<-genesseallm[1:24,]
plot(mapply(tf,2:365),main='Precipitation Cumulation Period vs. Correlation Result with Peak Flow',
ylab='Corellation Result',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf,2:365),col='red')
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
climate <- read.csv("project1_climate.csv")
genesseallm <- read.csv("project1_genesseall.csv")
genesseall<-genesseallm[1:24,]
tf<-function(nn){
movsum<-function(x){
filter(x,rep(1,nn),sides=1)
}
test<-data.frame(climate[,1],
as.numeric(movsum(climate[,2])))
test2<-data.frame(genesseall,
test[match(genesseall[,1],climate[,1]),2])
test2[is.na(test2)]<-0
test3<-cor(test2,method="spearman")
#test3<-rcorr(as.matrix(test2), type="spearman")$P[2,3]
#print(test2)
print(test3[2,3])
}
tf2<-function(nn){
movsum<-function(x){
filter(x,rep(1,nn),sides=1)
}
test<-data.frame(climate[,1],
as.numeric(movsum(climate[,2])))
test2<-data.frame(genesseall,
test[match(genesseall[,1],climate[,1]),2])
test2[is.na(test2)]<-0
#test3<-cor(test2,method="spearman")
test3<-rcorr(as.matrix(test2), type="spearman")$P[2,3]
#print(test2)
print(test3)
}
###############
par(mfrow=c(1,1))
genesseall<-genesseallm[1:24,]
plot(mapply(tf,2:365),main='Precipitation Cumulation Period vs. Correlation Result with Peak Flow',
ylab='Corellation Result',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf,2:365),col='red')
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
climate <- read.csv("project1_climate.csv")
genesseallm <- read.csv("project1_genesseall.csv")
genesseall<-genesseallm[1:24,]
tf<-function(nn){
movsum<-function(x){
filter(x,rep(1,nn),sides=1)
}
test<-data.frame(climate[,1],
as.numeric(movsum(climate[,2])))
test2<-data.frame(genesseall,
test[match(genesseall[,1],climate[,1]),2])
test2[is.na(test2)]<-0
test3<-cor(test2,method="spearman")
#test3<-rcorr(as.matrix(test2), type="spearman")$P[2,3]
#print(test2)
print(test3[2,3])
}
tf2<-function(nn){
movsum<-function(x){
filter(x,rep(1,nn),sides=1)
}
test<-data.frame(climate[,1],
as.numeric(movsum(climate[,2])))
test2<-data.frame(genesseall,
test[match(genesseall[,1],climate[,1]),2])
test2[is.na(test2)]<-0
#test3<-cor(test2,method="spearman")
test3<-rcorr(as.matrix(test2), type="spearman")$P[2,3]
#print(test2)
print(test3)
}
###############
par(mfrow=c(2,1))
genesseall<-genesseallm[1:24,]
plot(mapply(tf,2:365),main='Precipitation Cumulation Period vs. Correlation Result with Peak Flow',
ylab='Corellation Result',
xlab='Precipitation Cumulation Period (days)')
genesseall<-genesseallm[28:90,]
points(mapply(tf,2:365),col='red')
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
#################
genesseall<-genesseallm[1:24,]
plot(mapply(tf2,2:365),main='P values',
ylab='P values',
xlab='Precipitation Cumulation Period (days)',
ylim=c(0,0.1))
genesseall<-genesseallm[28:90,]
points(mapply(tf2,2:365),col='red')
#abline(h=0.1)
legend('topright',c('before_dam','after_dam'),
pch=1,
col=c('black','red'))
polygon(c(-100,400,400,-100),c(0.05,0.05,0,0), col=rgb(0.22, 0.22, 0.22,0.5))
genesseall<-genesseallm[1:24,]
genesseall2<-genesseallm[28:90,]
boxplot(genesseall)
boxplot(genesseall[,2])
par(mfrow=c(1,1))
boxplot(genesseall[,2])
boxplot(genesseall[,2],genesseall2[,2])
boxplot(genesseall[,2],genesseall2[,2],xlab=c('before dam construction','after dam construction'))
boxplot(genesseall[,2],genesseall2[,2],xlab=paste('before dam construction','after dam construction'))
axis(1,labels=c('before','after'))
axis(1,at=1:2,labels=c('before','after'))
axis(1,at=1:2,labels=c('before dam construction','after dam construction'))
boxplot(genesseall[,2],genesseall2[,2])
axis(1,at=1:2,labels=c('before dam construction','after dam construction'))
boxplot(genesseall[,2],genesseall2[,2],xaxt = "n")
axis(1,at=1:2,labels=c('before dam construction','after dam construction'))
boxplot(genesseall[,2],genesseall2[,2],xaxt = "n",ylab="peakflow (cfs)")
axis(1,at=1:2,labels=c('before dam construction','after dam construction'))
Data <- data.frame(
Y=c(before,after),
Site =factor(rep(c("before", "after"), times=c(length(before), length(after))))
)
before<-genesseallm[1:24,]
after<-genesseallm[28:90,]
boxplot(genesseall[,2],genesseall2[,2],xaxt = "n",ylab="peakflow (cfs)")
axis(1,at=1:2,labels=c('before dam construction','after dam construction'))
Data <- data.frame(
Y=c(before,after),
Site =factor(rep(c("before", "after"), times=c(length(before), length(after))))
)
before<-genesseallm[1:24,][,2]
after<-genesseallm[28:90,][,2]
boxplot(genesseall,genesseall2,xaxt = "n",ylab="peakflow (cfs)")
axis(1,at=1:2,labels=c('before dam construction','after dam construction'))
before<-genesseallm[1:24,][,2]
after<-genesseallm[28:90,][,2]
boxplot(before,after,xaxt = "n",ylab="peakflow (cfs)")
axis(1,at=1:2,labels=c('before dam construction','after dam construction'))
Data <- data.frame(
Y=c(before,after),
Site =factor(rep(c("before", "after"), times=c(length(before), length(after))))
)
View(Data)
View(Data)
aov(Y~site,data=Data)
aov(Y~Site,data=Data)
fit<-aov(Y~Site,data=Data)
summary(fit)
plot(fit)
hist(before)
hist(after)
qqnorm(Data$Y)
qqline(Data$Y)
sqrt(637253257)
TukeyHSD(fit)
